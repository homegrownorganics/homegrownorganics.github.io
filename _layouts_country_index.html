<!--
  country_index.html: Aggregates all listings for a country across all collections.
  Groups by type (Farms, Markets, etc.) and renders each using listing-card.html.
  Expects page.title to be the country name.
-->
{% assign country = page.title %}
{% extends "default" %}
{% block content %}
<h1>{{ country }}</h1>
<p>All listings for {{ country }}, grouped by category.</p>

{% assign collections = "farms,markets,stores,restaurants,distributors" | split: ',' %}
{% for c in collections %}
  {% assign records = site[c] | where: "country", country %}
  {% if records.size > 0 %}
    <h2>{{ c | capitalize }}</h2>
    <div class="listing-grid">
      {% for item in records %}
        {% include listing-card.html item=item type=c %}
      {% endfor %}
    </div>
  {% endif %}
{% endfor %}
{% endblock %}